# Поиск уязвимостей в ассемблерном коде и использование патча для взлома

## Задача

Дан файл с разрешение .com.  Необходимо при помощи средств дизассемблера найти и воспользоваться уязвимостями в коде, который оставил автор, чтобы получить условный доступ к защищенной информации(программа должна вывести сообщение "Доступ разрешен" или что-то подобное при вводе неправильного пароля). Использовать два типа взлома:

**1) Особый набор вводимых данных**:

В этом варианте взлома нужно использовать какой-либо набор входных данных, при которых  программа работает не корректно.

**2) Патч:**

В этом варианте взлома нужно написать программу на C, которая в бинарном файле меняет некоторые байты, что приводит к уничтожению защиты.

## Решение

**1) Первый варинт взлома**

 - В файле passw_1.com первая уязвимсоть проявляется, если вместо ввода первого символа нажать Backspace и Enter.
 - Вторая уязвимость заключается в том, что автор в памяти хранит зашифрованный пароль сразу после буфера, в который при вводе записываются данные, при этом размеры буфера не контролируюся. Вводимы символы сразу преобразуюся согласно шифрованию, реализованному автором,  поэтому достаточно два раза ввести однинаковые данные, перезаписав тем самым исходный пароль. Длина исходного пароля: 8 символов.
 - Сразу после буфера ввода и пароля хранится строка, которая выводится при неправильно набранном пароле, поэтому можно ввести 16 любых символов, а потом символы строки, заканчивающиеся знаком "$". При этом необходимо учесть, что ASCII коды вводимых символов на 3 меньше, чем коды сиволов, которые будут отображены, потому что автор использует шифр Цезаря и сразу преобразует введенные данные, чтобы сравнить с зашифрованным паролем.

**2) Второй вариант взлома**

- Автор программы в файле passw_2.com испольует хэш для проверки пароля. Хэш введенных данных сравнивается с хэшом пароля и в случае совпадения в регистр ax записывается 1, иначе - 0. Патч меняет код так, что в ax в любом случае записывается 1. (В репозитории находится файл до взлома)
  
  - **Было:**
    <img width="958" alt="image" src="https://github.com/1progwriter1/Patch/assets/112411575/f2adb71d-bb69-4b6a-9367-ab91c7c0267c">

  - **Стало:**
    <img width="997" alt="image" src="https://github.com/1progwriter1/Patch/assets/112411575/f1eb384d-9f66-4ee1-9243-043e93161650">


